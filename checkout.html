<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - SSU New Gen TechMart</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<header>
    <h1>SSU New Gen TechMart</h1>
    <nav>
        <a href="index.html">Home</a>
        <a href="shop.html">Shop</a>
        <a href="cart.html" class="header-cart cart-btn" aria-label="View cart">
            <svg class="cart-icon-svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 6h15l-1.5 9h-12z"></path>
                <circle cx="9" cy="20" r="1"></circle>
                <circle cx="19" cy="20" r="1"></circle>
            </svg>
            <span class="cart-count">0</span>
        </a>
        <a href="login.html" class="login-btn">Login</a>
    </nav>
</header>

<div class="container" style="max-width: 900px; margin: 40px auto;">
    <h2>Checkout</h2>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 30px;">
        
        <!-- Shipping Information -->
        <div class="glass-container">
            <h3>Shipping Information</h3>
            <form id="checkoutForm">
                <div style="margin-bottom: 15px;">
                    <label for="fullName">Full Name *</label>
                    <input type="text" id="fullName" name="fullName" required placeholder="John Doe">
                </div>

                <div style="margin-bottom: 15px;">
                    <label for="email">Email *</label>
                    <input type="email" id="email" name="email" required placeholder="john@example.com">
                </div>

                <div style="margin-bottom: 15px;">
                    <label for="phone">Phone *</label>
                    <input type="tel" id="phone" name="phone" required placeholder="+1 (555) 123-4567">
                </div>

                <div style="margin-bottom: 15px;">
                    <label for="address">Street Address *</label>
                    <input type="text" id="address" name="address" required placeholder="123 Main St">
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label for="city">City *</label>
                        <input type="text" id="city" name="city" required placeholder="New York">
                    </div>
                    <div>
                        <label for="state">State *</label>
                        <input type="text" id="state" name="state" required placeholder="NY">
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label for="zipcode">ZIP Code *</label>
                        <input type="text" id="zipcode" name="zipcode" required placeholder="10001">
                    </div>
                    <div>
                        <label for="country">Country *</label>
                        <input type="text" id="country" name="country" required placeholder="USA">
                    </div>
                </div>

                <div style="margin-bottom: 15px;">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="sameAsBilling" name="sameAsBilling" checked>
                        <span>Billing address same as shipping</span>
                    </label>
                </div>
            </form>
        </div>

        <!-- Order Summary -->
        <div class="glass-container">
            <h3>Order Summary</h3>
            <div id="checkoutSummary" style="margin-bottom: 20px;"></div>

            <!-- Payment Method -->
            <h4 style="margin-top: 20px; margin-bottom: 10px;">Payment Method</h4>
            <form id="paymentForm">
                <div style="margin-bottom: 15px;">
                    <label for="cardName">Cardholder Name *</label>
                    <input type="text" id="cardName" name="cardName" required placeholder="John Doe">
                </div>

                <div style="margin-bottom: 15px;">
                    <label for="cardNumber">Card Number *</label>
                    <input type="text" id="cardNumber" name="cardNumber" required placeholder="4532 1234 5678 9010" maxlength="19">
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label for="expiry">Expiry Date *</label>
                        <input type="text" id="expiry" name="expiry" required placeholder="MM/YY" maxlength="5">
                    </div>
                    <div>
                        <label for="cvv">CVV *</label>
                        <input type="text" id="cvv" name="cvv" required placeholder="123" maxlength="4">
                    </div>
                </div>

                <div id="paymentError" style="color: #dc2626; margin-bottom: 10px; display: none;"></div>

                <button type="submit" class="btn" style="width: 100%; margin-top: 10px;">Complete Purchase</button>
                <a href="cart.html" class="btn secondary" style="width: 100%; margin-top: 10px; text-align: center; display: block;">Back to Cart</a>
            </form>
        </div>
    </div>
</div>

<footer>
    © 2025 SSU New Gen TechMart. All rights reserved.
</footer>

<script src="script.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Display cart summary in checkout
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    const summaryDiv = document.getElementById('checkoutSummary');
    
    if (cart.length === 0) {
        summaryDiv.innerHTML = '<p style="color: #666;">Your cart is empty</p>';
        return;
    }

    const subtotal = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
    const shipping = 5.00;
    const tax = (subtotal * 0.08).toFixed(2); // 8% tax
    const total = (subtotal + shipping + parseFloat(tax)).toFixed(2);

    let cartHTML = '<div style="border-bottom: 1px solid #ddd; padding-bottom: 10px; margin-bottom: 10px;">';
    cart.forEach(item => {
        cartHTML += `<div style="display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.9em;">
            <span>${item.name} × ${item.qty}</span>
            <span>$${(item.price * item.qty).toFixed(2)}</span>
        </div>`;
    });
    cartHTML += '</div>';
    
    cartHTML += `
        <div style="margin-bottom: 8px; display: flex; justify-content: space-between;">
            <span>Subtotal:</span>
            <span>$${subtotal.toFixed(2)}</span>
        </div>
        <div style="margin-bottom: 8px; display: flex; justify-content: space-between;">
            <span>Tax (8%):</span>
            <span>$${tax}</span>
        </div>
        <div style="margin-bottom: 8px; display: flex; justify-content: space-between;">
            <span>Shipping:</span>
            <span>$${shipping.toFixed(2)}</span>
        </div>
        <div style="padding-top: 10px; border-top: 2px solid #ddd; display: flex; justify-content: space-between; font-weight: bold; font-size: 1.1em;">
            <span>Total:</span>
            <span>$${total}</span>
        </div>
    `;
    
    summaryDiv.innerHTML = cartHTML;

    // Pre-fill user info if logged in
    const user = (function(){ try { return JSON.parse(localStorage.getItem('user')); } catch(e){ return null; } })();
    if (user) {
        if (user.name) document.getElementById('fullName').value = user.name;
        if (user.email) document.getElementById('email').value = user.email;
    }

    // Handle form submission
    document.getElementById('paymentForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Validate form
        const fullName = document.getElementById('fullName').value;
        const email = document.getElementById('email').value;
        const phone = document.getElementById('phone').value;
        const address = document.getElementById('address').value;
        const city = document.getElementById('city').value;
        const state = document.getElementById('state').value;
        const zipcode = document.getElementById('zipcode').value;
        const country = document.getElementById('country').value;
        
        if (!fullName || !email || !phone || !address || !city || !state || !zipcode || !country) {
            alert('Please fill in all required fields');
            return;
        }

        // Basic payment validation
        const cardNumber = document.getElementById('cardNumber').value.replace(/\s/g, '');
        const expiry = document.getElementById('expiry').value;
        const cvv = document.getElementById('cvv').value;

        if (cardNumber.length < 13 || cardNumber.length > 19) {
            document.getElementById('paymentError').textContent = 'Invalid card number';
            document.getElementById('paymentError').style.display = 'block';
            return;
        }

        if (!expiry.match(/^\d{2}\/\d{2}$/)) {
            document.getElementById('paymentError').textContent = 'Invalid expiry date (use MM/YY)';
            document.getElementById('paymentError').style.display = 'block';
            return;
        }

        if (cvv.length < 3 || cvv.length > 4) {
            document.getElementById('paymentError').textContent = 'Invalid CVV';
            document.getElementById('paymentError').style.display = 'block';
            return;
        }

        // Create order object
        const order = {
            id: 'ORD-' + Date.now(),
            date: new Date().toISOString(),
            fullName: fullName,
            email: email,
            address: address + ', ' + city + ', ' + state + ' ' + zipcode + ', ' + country,
            items: cart,
            subtotal: subtotal.toFixed(2),
            tax: tax,
            shipping: shipping.toFixed(2),
            total: total,
            status: 'Processing'
        };

        // Save order to orders array
        let orders = [];
        try {
            orders = JSON.parse(localStorage.getItem('orders')) || [];
        } catch (e) {
            orders = [];
        }
        orders.push(order);
        localStorage.setItem('orders', JSON.stringify(orders));

        // Clear cart after successful order
        localStorage.setItem('cart', JSON.stringify([]));
        
        // Show success and redirect
        alert('Order placed successfully!\n\nThank you for your purchase, ' + fullName + '!\n\nOrder ID: ' + order.id);
        window.location.href = 'index.html';
    });
});
</script>
</body>
</html>
